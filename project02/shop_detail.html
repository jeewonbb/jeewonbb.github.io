<!DOCTYPE html>
<html lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<title>째깍악어 공식 홈페이지</title>
<link href="css/slick.css" rel="stylesheet" type="text/css">
<link href="css/style.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/slick.min.js"></script>
</head>
<body>
<div class="container product_detail"><!--container S-->
    <div class="in_box"><!--in_box S-->
        <div class="product_top">
            <div class="thumb_box">
                <div class="thumb_l shopthumbSlide">
                    <img src="img/list_thumb_0311.png" alt="상품썸네일">
                    <img src="img/detail_thumb_l_01.png" alt="상품썸네일">
                    <img src="img/detail_thumb_l_02.png" alt="상품썸네일">
                    <img src="img/detail_thumb_l_03.png" alt="상품썸네일">
                    <img src="img/detail_thumb_l_04.png" alt="상품썸네일">
                    <img src="img/detail_thumb_l_05.png" alt="상품썸네일">
                    <img src="img/detail_thumb_l_06.png" alt="상품썸네일">
                    <img src="img/detail_thumb_l_07.png" alt="상품썸네일">
                    <img src="img/detail_thumb_l_08.png" alt="상품썸네일">
                </div>
                <div class="thumb_s shopthumbNavSlide">
                    <img src="img/list_thumb_s_0310.png" alt="상품썸네일">
                    <img src="img/detail_thumb_s_01.png" alt="상품썸네일">
                    <img src="img/detail_thumb_s_02.png" alt="상품썸네일">
                    <img src="img/detail_thumb_s_03.png" alt="상품썸네일">
                    <img src="img/detail_thumb_s_04.png" alt="상품썸네일">
                    <img src="img/detail_thumb_s_05.png" alt="상품썸네일">
                    <img src="img/detail_thumb_s_06.png" alt="상품썸네일">
                    <img src="img/detail_thumb_s_07.png" alt="상품썸네일">
                    <img src="img/detail_thumb_s_08.png" alt="상품썸네일">
                </div>
            </div>
            <div class="product_box">
                <div class="product_txt">
                    <p class="tit">[째깍악어 육아연차권]</p>
                    <p class="sub_txt">3만원/5만원/10만원 모바일 상품권</p>
                    <p class="price"><strong>30,000</strong>원~</p>
                </div>

                <div class="product_option">
                    <div class="product_option_box">
                        <div class="product_option_bg">
                            <span class="option_bg"></span>
                            <span class="mob_close"></span>
                        </div>
                        <div class="product_option_box_in">
                            <div class="drop-down01">
                                <select class="productname sel_option" name="nameoption">
                                    <option value="00" style="background-image:url('img/list_thumb_s_0310.png');">상품명</option>
                                    <option value="01" style="background-image:url('img/detail_thumb_s_01.png');">01_나를 보살필 시간</option>
                                    <option value="02" style="background-image:url('img/detail_thumb_s_02.png');">02_남편과의 데이트</option>
                                    <option value="03" style="background-image:url('img/detail_thumb_s_03.png');">03_둘만의 데이트</option>
                                    <option value="04" style="background-image:url('img/detail_thumb_s_04.png');">04_등하원 프리패스권</option>
                                    <option value="05" style="background-image:url('img/detail_thumb_s_05.png');">05_복직 성공 찬스</option>
                                    <option value="06" style="background-image:url('img/detail_thumb_s_06.png');">06_시간을 선물합니다</option>
                                    <option value="07" style="background-image:url('img/detail_thumb_s_07.png');">07_아내와의 데이트</option>
                                    <option value="08" style="background-image:url('img/detail_thumb_s_08.png');">08_커피 한 잔의 여유</option>
                                </select>
                            </div>
                            <div class="drop-down02">
                                <p>상품권 가격</p>
                                <ul class="productprice" name="priceoption">
                                    <li id="price_30000">3만원 모바일 상품권 : <span>30000원</span></li>
                                    <li id="price_50000">5만원 모바일 상품권 : <span>50000원</span></li>
                                    <li id="price_100000">10만원 모바일 상품권 : <span>100000원</span></li>
                                </ul>
                            </div>

                            <div class="option_btm">

                                <div class="prod"></div>
                                <div class="ex_txt">작성한 구매자 연락처가 틀릴시 구매내역을 확인할 수 없으므로 정확히 입력해주세요.</div>
                                <div class="input_box">
                                    <input type="text" id="buy_phone" name="buy_phone" numberOnly placeholder="구매자 실제 연락처를 작성해주세요 (필수-숫자만 입력 가능)">
                                </div>
                                <div class="input_box">
                                    <input type="text" id="phone" name="phone" numberOnly placeholder="상품권을 전송 받을 연락처를 작성해주세요. (필수-숫자만 입력 가능)">
                                </div>
                                <div class="input_box">
                                    <input type="text" id="sms_msg" name="sms_msg" placeholder="전달 또는 작성하고 싶은 문자 내용을 작성해주세요.(선택)">
                                </div>
                                <div class="price clearfix">
                                    <strong>합계</strong>
                                    <span><strong class="price_total">0</strong>원</span>
                                </div>


                            </div>
                        </div>
                    </div>
                    <div class="btn_box">
                        <button class="black-btn btn btn_w100 mob_order_btn">구매 하기</button>
                        <button class="black-btn btn btn_w100 order_btn">바로 구매</button>
                    </div>
                </div>
            </div>
        </div>

    </div><!--in_box E-->
</div><!--container E-->

<script type="text/javascript">
    var counter_plus=0;
    var counter_option_plus=0;
    $(document).ready(function(){

        //상품권
        $('.drop-down01').append('<div class="clone-slt"></div>');
        $('.drop-down01').append('<ul class="select-list"></ul>');

        $('.drop-down01 select option').each(function() {
            counter_option_plus++;
            var bg = $(this).css('background-image');

            $('.select-list').append('<li class="clsAnchor sel_option" id="sel_option_'+$(this).val()+'" at="'+$(this).val()+'"><span value="' + $(this).val() + '" class="slt-thumb" style=background-image:' + bg + '>' + $(this).text() + '</span></li>');
        });

        $('.drop-down01 .clone-slt').html('<span style=background-image:' + $('.drop-down01 select').find(':selected').css('background-image') + '>' + $('.drop-down01 select').find(':selected').text() + '</span>' + '<a href="javascript:void(0);" class="select-list-link">Arrow</a>');

        $('.drop-down01 ul li').each(function() {
            if ( $(this).find('span').text() == $('.drop-down01 select').find(':selected').text()) {
                $(this).addClass('active');
            }
        });

        $('.drop-down01 .select-list span').on('click', function(){


        //w_height++;
            var dd_text = $(this).text();
            var dd_img = $(this).css('background-image');
            var dd_val = $(this).attr('value');
            var price_text = $(this).text();
        //var w_height = $('.wish-box').height();

            $('.drop-down01 .clone-slt').html('<span style=background-image:' + dd_img + '>' + dd_text + '</span>' + '<a href="javascript:void(0);" class="select-list-link">Arrow</a>');
            $('.drop-down01 .select-list span').parent().removeClass('active');
            $(this).parent().addClass('active');
            $('.drop-down01 select[name=nameoption]').val( dd_val );


            $('.drop-down01 .select-list li').slideUp();
            $('.productprice').slideDown();


            var prod_val = $('.productname option:selected').val();
            console.log("첫번째 sel : "+prod_val);
            select_check(prod_val);

        });

        $('.drop-down01 .clone-slt').on('click','a.select-list-link', function(){
            $('.drop-down01 ul li').slideToggle();
            $(".drop-down01 ul li:first-child").css("display","none");


            //var at = $("#sel_option_"+counter_plus).attr("at");
            //console.log("at1 : " +counter_plus);
            //$("#sel_option_"+at).css("display","none");

            /*

            $("#sel_option_"+counter_plus).css("display","none");
            console.log("at2 : " +counter_plus);*/

        });


        //상품권 가격
        $('.drop-down02 p').click(function(){

            var first_sel=$(".sel_option option:selected").val();
            if(first_sel == "00"){
                alert("상품명을 먼저 선택 해주세요.");
                return false;
            }
            $('.productprice').slideToggle();
            $('.drop-down01 ul li').slideUp();
            $('.productprice').toggleClass('active');
        });

        $('.productprice li').click(function(){
            $('.productprice').slideUp();

            var prod = $('.productname option:not(:first):selected').text();
            var prod_val = $('.productname option:not(:first):selected').val();
            var price = $(this).find('span').text();
            var price_txt=numberWithCommas($(this).find('span').text());

            //console.log(prod,price);

            //$("#sel_option_"+prod_val).addClass("dp_none");

            $('.prod').append('<div class="price_rows"><div><span>'+prod+'</span><span class="close_btn prod_option" id="close_btn_'+prod_val+'" at="'+prod_val+'"></span></div><div class="price_btn"><input type="button" value="-" class="minus_btn"/><input type="text" value="1" class="number" name="gift_card_cnt[]" /><input type="button" value="+" class="plus_btn"/></div><input type="hidden" name="gift_at[]" value="'+prod_val+'"><input type="hidden" name="gift_card_unit[]" value="'+price.replace(/만|원|,/gi, '')+'"><div class="price_unit" price="'+price.replace(/만|원|,/gi, '')+'" >'+price_txt+'</div></div>').show();
            //$('.price_total').text(get_totalPrice());
            select_check(prod_val);
            get_totalPrice();
        });

        //갯수 선택
        $( 'body' ).on( 'click', '.prod .price_btn > :button', function(){
            var $ths = $(this);
            var $par = $ths.parent().parent();
            var $obj = $par.find('input[type="text"]');
            var val = $obj.val();
            if ($ths.val()=='-') {
                if (val > 1)
                    $obj.val(--val);
            }
            else if ($ths.val()=='+') {
                if (val < 30)
                    $obj.val(++val);
            }

            var $tar = $par.find('.price_unit');
            var cal=parseInt($tar.attr('price')*val);
            cal=numberWithCommas(cal);
            //console.log("cal : "+cal);
            $tar.text(cal + '원');
            //$('.price_total').text(get_totalPrice());
            //$('.price_total').toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            get_totalPrice();
        });

    }); //ready

    //총금액구하기
    function get_totalPrice() {
        var total = 0;
        var rep="";
        //var num = $('.number').text();
        $('.price_unit').each(function(k, v) {
            rep=$(v).text().replace(",","");
            rep=rep.replace("원","");
            //console.log("rep : "+rep);
            total = total + parseInt(rep);


        });
        total=numberWithCommas(total);
        //console.log("total : "+total);
        $('.price_total').text(total);
        //return total;
    }

    $(document).on("click",".prod_option",function(){
        var at = $(this).attr("at");

        //$('#sel_option_'+at).removeClass("dp_none");
        //$('#sel_option_'+at).css("display","none");

        select_check(at);

        $(this).parent().parent().remove();
        //$('.price_total').text(get_totalPrice());
        //$('.price_total').toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        get_totalPrice();
    });

    function numberWithCommas(x) {
        return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    // 720 바로구매
    if ($(window).width() <= 720) {
        $('.mob_order_btn').click(function(){
            $(this).hide();
            $('.order_btn').show();
            $('.product_option_bg').show();
            $('.product_option_box').show();
            $('body').addClass('hidden');
            order_buy();
    //order_buy();
        });
        $('.mob_close').click(function(){
            $('.product_option_bg').hide();
            $('.product_option_box').hide();
            $('.mob_order_btn').show();
            $('.order_btn').hide();
            $('body').removeClass('hidden');
        });

    }else{
        $('.mob_order_btn').click(function(){
            $(this).hide();
            $('.order_btn').show();
            $('.product_option_bg').show();
            $('.product_option_box').show();
    //order_buy();
        });
    }

    $(window).resize(function(){
        if ($(window).width() <= 720) {
            $('.mob_order_btn').click(function(){
                $(this).hide();
                $('.order_btn').show();
                $('.product_option_bg').show();
                $('.product_option_box').show();
    //order_buy();
            });
            $('.mob_close').click(function(){
                $('.product_option_bg').hide();
                $('.product_option_box').hide();
                $('.mob_order_btn').show();
                $('.order_btn').hide();
            });
        }
    });



    function select_check(at){

        $('#price_30000').css("display","");
        $('#price_50000').css("display","");
        $('#price_100000').css("display","");


        var card_at=[];
        $("input[name='gift_at[]']").each(function(){
            card_at.push($(this).val());
        });

        var card_unit=[];
        $("input[name='gift_card_unit[]']").each(function(){
            card_unit.push($(this).val());
        });
        var chn_ok="";
        //조합
        for(var i=0; i<card_at.length; i++){
            console.log("for문 at:"+at+" / card_at[i] : "+card_at[i]+" / card_unit[i] : "+card_unit[i]);
        //선택한값과 선택되어있는값이 같다면
            if(at==card_at[i]){
                console.log("비활성화 할 지금 선택한 at:"+at+" / 선택되어 있던 card_at[i] : "+card_at[i]+" / card_unit[i] : "+card_unit[i]);
                $('#price_'+card_unit[i]).css("display","none");
                chn_ok="y"
            }
        }

        //없을땐 초기화
        if(chn_ok == ""){
            console.log("초기화 ok");
        //선택한값과 선택되어있는값이 같다면
            $('#price_30000').css("display","");
            $('#price_50000').css("display","");
            $('#price_100000').css("display","");
        }
    }

    $('.order_btn').click(function(){
        order_buy();
    });

    function order_buy(){

        var gift_card_cnt=[];
        $("input[name='gift_card_cnt[]']").each(function(){
            gift_card_cnt.push($(this).val());
        });

        var gift_card_unit=[];
        $("input[name='gift_card_unit[]']").each(function(){
            gift_card_unit.push($(this).val());
        });

        console.log("gift_card_cnt : "+gift_card_cnt+" / gift_card_unit : "+gift_card_unit);


        if(gift_card_cnt == "" || gift_card_unit == ""){
            alert("상품 선택 후 구매 버튼을 눌러주세요.");
            return false;
        }
        var buy_phone=$("#buy_phone").val();
        if(buy_phone==""){
            alert("구매자 연락처를 정확히 입력해주세요.");
            return false;
        }

        var phone=$("#phone").val();
        if(phone==""){
            alert("쿠폰을 수신 받을 연락처를 정확히 입력해주세요.");
            return false;
        }
    }

    //전화번호 숫자만 입력
    $("input:text[numberOnly]").on("keyup", function() {
        $(this).val($(this).val().replace(/[^0-9]/g,""));
    });

    $('.shopthumbSlide').slick({
            slidesToShow: 1,
            slidesToScroll: 1,
            arrows: false,
            dots:false,
            infinite: false,
            autoplay: false,
            autoplaySpeed: 5000,
            asNavFor: '.shopthumbNavSlide',
            responsive: [{
                breakpoint:780,
                settings: {
                    autoplay: true,
                    dots:true,
                }
            }]
        });

        //슬라이드 네비 썸네일
        $('.shopthumbNavSlide').slick({
            slidesToShow: 5,
            slidesToScroll: 5,
            asNavFor: '.shopthumbSlide',
            focusOnSelect: true,
            infinite: false,
            responsive: [{
                breakpoint:480,
                settings: "unslick"
            }]
        });

        $(window).on('resize', function() {
            $('.shopthumbSlide').slick('resize');
            $('.shopthumbNavSlide').slick('resize');
        });
</script>

</body>
<!-- End Body -->
</html>


